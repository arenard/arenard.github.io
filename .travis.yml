branches:
  only:
    - source
cache:
  apt: true
env: 
  - HUGO_VERSION="0.10" secure: "Kpn6PVrVhlg+iq5tLAn3zLwLwTYYvEAgcMt8bhJAg0BER4UKgTcx8JvcPTaIr4EyoqMXk/YBRQpEeH9d4AsvCupwxYBlLhF4fjNTagIJJdObq5V0eYsNRHHnJUbiU1EkVtcOnbdVEz84u7xGo4J1bCI1gnzEY+3RnjZiUxeO4HE=" 

before_install:
  - mkdir -p ${HOME}/temp
  - cd ${HOME}/temp
  - curl --compressed --create-dirs --location --remote-name --remote-time --retry 3 --show-error --url https://github.com/spf13/hugo/releases/download/v${HUGO_VERSION}/hugo_${HUGO_VERSION}_linux_amd64.tar.gz
  - tar -xzf hugo_${HUGO_VERSION}_linux_amd64.tar.gz

install:
  - sudo mv hugo_${HUGO_VERSION}_linux_amd64/hugo_${HUGO_VERSION}_linux_amd64 /usr/local/bin/hugo
  - sudo apt-get install python-pygments
  - cd ${TRAVIS_BUILD_DIR}
  - rm -Rf ${HOME}/temp 

script:
  - hugo -s .

after_success:
  - git config --global user.email "arenard@travis-ci.org"
  - git config --global user.name "Travis-CI"
  - git config --global push.default simple
  - mkdir -p ${HOME}/temp
  - cd ${HOME}/temp
  - git clone --branch=master git://github.com/${TRAVIS_REPO_SLUG}.git ${TRAVIS_REPO_SLUG}
  - cd ${TRAVIS_REPO_SLUG}
  - mv ${TRAVIS_BUILD_DIR}/public/* .
  - git add -A .
  - git commit -m "Travis build ${TRAVIS_BUILD_NUMBER}"
  - git push
